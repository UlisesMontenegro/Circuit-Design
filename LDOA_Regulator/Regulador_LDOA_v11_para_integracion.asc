Version 4
SHEET 1 2316 856
WIRE -8688 -2384 -9024 -2384
WIRE -8464 -2384 -8688 -2384
WIRE -8144 -2384 -8464 -2384
WIRE -8000 -2384 -8048 -2384
WIRE -7936 -2384 -8000 -2384
WIRE -7776 -2384 -7856 -2384
WIRE -7072 -2384 -7776 -2384
WIRE -6752 -2384 -7072 -2384
WIRE -6752 -2304 -6752 -2384
WIRE -8576 -2256 -8624 -2256
WIRE -8528 -2256 -8576 -2256
WIRE -7776 -2256 -7776 -2384
WIRE -8096 -2224 -8096 -2320
WIRE -8000 -2224 -8000 -2384
WIRE -8688 -2176 -8688 -2208
WIRE -8576 -2176 -8576 -2256
WIRE -8576 -2176 -8688 -2176
WIRE -7072 -2176 -7072 -2384
WIRE -8464 -2144 -8464 -2208
WIRE -8352 -2144 -8464 -2144
WIRE -8272 -2144 -8352 -2144
WIRE -8048 -2144 -8048 -2160
WIRE -8048 -2144 -8272 -2144
WIRE -8688 -2096 -8688 -2176
WIRE -8464 -2096 -8464 -2144
WIRE -6752 -2096 -6752 -2224
WIRE -8752 -2048 -8816 -2048
WIRE -7776 -2048 -7776 -2176
WIRE -7776 -2048 -8400 -2048
WIRE -7776 -2032 -7776 -2048
WIRE -8352 -1984 -8352 -2144
WIRE -8688 -1968 -8688 -2000
WIRE -8576 -1968 -8688 -1968
WIRE -8464 -1968 -8464 -2000
WIRE -8464 -1968 -8576 -1968
WIRE -7776 -1936 -7776 -1952
WIRE -7568 -1936 -7776 -1936
WIRE -7776 -1920 -7776 -1936
WIRE -7456 -1856 -7520 -1856
WIRE -8352 -1824 -8352 -1920
WIRE -8352 -1824 -9024 -1824
WIRE -8320 -1824 -8352 -1824
WIRE -7776 -1824 -7776 -1840
WIRE -7776 -1824 -8320 -1824
WIRE -7568 -1824 -7568 -1840
WIRE -7568 -1824 -7776 -1824
WIRE -7072 -1824 -7072 -2096
WIRE -7072 -1824 -7568 -1824
WIRE -6752 -1824 -6752 -2032
WIRE -6752 -1824 -7072 -1824
WIRE -8320 -1792 -8320 -1824
WIRE -7648 -1696 -7648 -1712
WIRE -7744 -1680 -7744 -1712
WIRE -7888 -1600 -7920 -1600
WIRE -7744 -1600 -7808 -1600
WIRE -7712 -1600 -7744 -1600
WIRE -7648 -1600 -7648 -1616
WIRE -7648 -1600 -7680 -1600
WIRE -7520 -1600 -7648 -1600
WIRE -7392 -1600 -7520 -1600
WIRE -7136 -1584 -7152 -1584
WIRE -6944 -1584 -7056 -1584
WIRE -6832 -1584 -6944 -1584
WIRE -7920 -1568 -7920 -1600
WIRE -7712 -1568 -7712 -1600
WIRE -7680 -1568 -7680 -1600
WIRE -7520 -1568 -7520 -1600
WIRE -6720 -1568 -6768 -1568
WIRE -6656 -1568 -6720 -1568
WIRE -6448 -1568 -6576 -1568
WIRE -6304 -1568 -6448 -1568
WIRE -7392 -1552 -7392 -1600
WIRE -6832 -1552 -6880 -1552
WIRE -6208 -1552 -6240 -1552
WIRE -6160 -1552 -6208 -1552
WIRE -6944 -1536 -6944 -1584
WIRE -6304 -1536 -6352 -1536
WIRE -9008 -1488 -9008 -1520
WIRE -6880 -1488 -6880 -1552
WIRE -6720 -1488 -6720 -1568
WIRE -6720 -1488 -6880 -1488
WIRE -9328 -1456 -9328 -1552
WIRE -7696 -1456 -7696 -1504
WIRE -7520 -1456 -7520 -1488
WIRE -7520 -1456 -7696 -1456
WIRE -7392 -1456 -7392 -1488
WIRE -7392 -1456 -7520 -1456
WIRE -8512 -1440 -8512 -1584
WIRE -6944 -1424 -6944 -1456
WIRE -7936 -1408 -7984 -1408
WIRE -7904 -1408 -7936 -1408
WIRE -7696 -1408 -7696 -1456
WIRE -7696 -1408 -7824 -1408
WIRE -6352 -1408 -6352 -1536
WIRE -6304 -1408 -6352 -1408
WIRE -6208 -1408 -6208 -1552
WIRE -6208 -1408 -6224 -1408
WIRE -9008 -1392 -9008 -1408
WIRE -8896 -1392 -9008 -1392
WIRE -8384 -1392 -8448 -1392
WIRE -8128 -1392 -8304 -1392
WIRE -8048 -1392 -8128 -1392
WIRE -9008 -1376 -9008 -1392
WIRE -8784 -1376 -8784 -1536
WIRE -7968 -1376 -7984 -1376
WIRE -6352 -1360 -6352 -1408
WIRE -8896 -1328 -8896 -1392
WIRE -8896 -1328 -8944 -1328
WIRE -8848 -1328 -8896 -1328
WIRE -7968 -1312 -7968 -1376
WIRE -7904 -1312 -7968 -1312
WIRE -8512 -1296 -8512 -1344
WIRE -9328 -1280 -9328 -1376
WIRE -8128 -1264 -8128 -1392
WIRE -8080 -1264 -8128 -1264
WIRE -7968 -1264 -7968 -1312
WIRE -7968 -1264 -8000 -1264
WIRE -9008 -1248 -9008 -1280
WIRE -8784 -1248 -8784 -1280
WIRE -6352 -1248 -6352 -1280
WIRE -7936 -1232 -7936 -1408
WIRE -7152 -1200 -7168 -1200
WIRE -6944 -1200 -7072 -1200
WIRE -6816 -1200 -6944 -1200
WIRE -6704 -1184 -6752 -1184
WIRE -6656 -1184 -6704 -1184
WIRE -6448 -1184 -6448 -1568
WIRE -6448 -1184 -6576 -1184
WIRE -6944 -1168 -6944 -1200
WIRE -6816 -1168 -6848 -1168
WIRE -8128 -1152 -8128 -1264
WIRE -8080 -1152 -8128 -1152
WIRE -7968 -1152 -7968 -1264
WIRE -7968 -1152 -8016 -1152
WIRE -9008 -1136 -9008 -1168
WIRE -8896 -1136 -9008 -1136
WIRE -8784 -1136 -8784 -1168
WIRE -8784 -1136 -8896 -1136
WIRE -7936 -1120 -7936 -1152
WIRE -6848 -1120 -6848 -1168
WIRE -6704 -1120 -6704 -1184
WIRE -6704 -1120 -6848 -1120
WIRE -8896 -1088 -8896 -1136
WIRE -6944 -1056 -6944 -1088
WIRE -3296 -880 -3408 -880
WIRE -3104 -880 -3216 -880
WIRE -2896 -880 -3104 -880
WIRE -2736 -880 -2896 -880
WIRE -2656 -880 -2736 -880
WIRE -3776 -864 -4000 -864
WIRE -3632 -864 -3776 -864
WIRE -3456 -864 -3632 -864
WIRE -3408 -848 -3408 -880
WIRE -2896 -848 -2896 -880
WIRE -2736 -848 -2736 -880
WIRE -4000 -832 -4000 -864
WIRE -3776 -832 -3776 -864
WIRE -3632 -832 -3632 -864
WIRE -3456 -832 -3456 -864
WIRE -4048 -816 -4096 -816
WIRE -4048 -768 -4096 -768
WIRE -3104 -768 -3104 -880
WIRE -2896 -736 -2896 -768
WIRE -2736 -736 -2736 -784
WIRE -4000 -704 -4000 -752
WIRE -3776 -704 -3776 -752
WIRE -3776 -704 -4000 -704
WIRE -3632 -704 -3632 -768
WIRE -3632 -704 -3776 -704
WIRE -3456 -704 -3456 -784
WIRE -3456 -704 -3632 -704
WIRE -3408 -704 -3408 -768
WIRE -3408 -704 -3456 -704
WIRE -3776 -672 -3776 -704
WIRE -4096 -560 -4096 -768
WIRE -3984 -560 -4096 -560
WIRE -3568 -560 -3984 -560
WIRE -3456 -560 -3568 -560
WIRE -3104 -560 -3104 -688
WIRE -3104 -560 -3376 -560
WIRE -3568 -544 -3568 -560
WIRE -3104 -512 -3104 -560
WIRE -3568 -464 -3568 -480
WIRE -3104 -400 -3104 -432
FLAG -8320 -1792 0
FLAG -7072 -2384 Vo
FLAG -8816 -2048 Vref1
FLAG -9024 -2384 VIN
FLAG -7776 -2048 Vf
FLAG -8000 -2384 Vs1
FLAG -7936 -1120 0
FLAG -8272 -2144 Vod
FLAG -7824 -1312 Vrefc
FLAG -7920 -1568 0
FLAG -6352 -1248 0
FLAG -6944 -1056 0
FLAG -6944 -1424 0
FLAG -7456 -1856 SELA
FLAG -9328 -1552 SELA
FLAG -9328 -1280 0
FLAG -6160 -1552 Vrefc
FLAG -7696 -1408 Vs
FLAG -8512 -1296 0
FLAG -8576 -1968 Pol
FLAG -8784 -1536 Pol
FLAG -2896 -736 0
FLAG -2736 -736 0
FLAG -3104 -400 0
FLAG -3776 -672 0
FLAG -3104 -560 Vfo_model
FLAG -3984 -560 Vfi_model
FLAG -2656 -880 Vo_model
FLAG -8896 -1088 0
FLAG -4096 -816 0
FLAG -3568 -464 0
FLAG -7744 -1712 Vs1
FLAG -7648 -1712 Vo
FLAG -8512 -1584 Vod
FLAG -7152 -1584 Vref
FLAG -7168 -1200 Vf
FLAG -6272 -1584 0
FLAG -6272 -1520 VIN
FLAG -6800 -1600 0
FLAG -6800 -1536 VIN
FLAG -6784 -1216 0
FLAG -6784 -1152 VIN
FLAG -8016 -1424 0
FLAG -8016 -1360 VIN
FLAG -7728 -1536 0
FLAG -7664 -1536 VIN
FLAG -9008 -1520 VIN
DATAFLAG -7536 -2384 ""
SYMBOL pnp -8624 -2208 R180
WINDOW 3 84 4 Left 2
SYMATTR Value BC327-25
SYMATTR InstName Q3
SYMBOL pnp -8528 -2208 M180
WINDOW 3 84 4 Left 2
SYMATTR Value BC327-25
SYMATTR InstName Q4
SYMBOL npn -8752 -2096 R0
WINDOW 3 56 60 Left 2
SYMATTR Value BC546B
SYMATTR InstName Q1
SYMBOL npn -8400 -2096 M0
WINDOW 3 56 60 Left 2
SYMATTR Value BC546B
SYMATTR InstName Q2
SYMBOL pnp -8048 -2320 M270
WINDOW 3 84 4 Left 2
SYMATTR Value TIP42C
SYMATTR InstName TIP42C
SYMBOL npn -8096 -2160 R270
WINDOW 3 65 14 Left 2
WINDOW 0 64 36 Left 2
SYMATTR Value Q2N6487
SYMATTR InstName Q2N6487
SYMBOL res -7792 -2272 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 3.16k
SYMATTR InstName Rf1
SYMBOL res -7792 -1936 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 840
SYMATTR InstName Rf2
SYMBOL res -7088 -2192 R0
SYMATTR InstName RL
SYMATTR Value {RL}
SYMBOL res -8704 -2400 R0
WINDOW 3 36 68 Left 2
SYMATTR Value {RE}
SYMATTR InstName R3
SYMBOL res -8480 -2400 R0
WINDOW 3 36 68 Left 2
SYMATTR Value {RE}
SYMATTR InstName R2
SYMBOL cap -6768 -2096 R0
SYMATTR InstName C3
SYMATTR Value {CL}
SYMBOL res -7840 -2400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rs
SYMATTR Value 0.1
SYMBOL res -7808 -1424 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL res -7808 -1328 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL res -7984 -1280 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res -7952 -1248 R0
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL npn -8448 -1440 M0
SYMATTR InstName Q7
SYMATTR Value 2N2222
SYMBOL res -7536 -1584 R0
SYMATTR InstName R9
SYMATTR Value 100k
SYMBOL res -7664 -1712 R0
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res -7728 -1696 M0
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res -7792 -1616 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 100k
SYMBOL res -7040 -1600 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 50k
SYMBOL res -6928 -1440 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL res -7168 -1184 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R15
SYMATTR Value 54.4k
SYMBOL res -6960 -1184 R0
SYMATTR InstName R16
SYMATTR Value 46k
SYMBOL res -6560 -1584 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL res -6560 -1200 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL res -6208 -1424 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 10k
SYMBOL res -6336 -1264 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL res -7792 -2048 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 1K
SYMATTR InstName Rf3
SYMBOL nmos -7520 -1936 M0
SYMATTR InstName M1
SYMATTR Value 2N7002
SYMBOL voltage -9328 -1472 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VSELA
SYMATTR Value 5
SYMBOL res -8288 -1408 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 100
SYMBOL npn -8944 -1376 M0
SYMATTR InstName Q8
SYMATTR Value BC546B
SYMBOL res -9024 -1504 R0
SYMATTR InstName R8
SYMATTR Value 4.7K
SYMBOL g2 -4000 -736 M180
SYMATTR InstName gmPD
SYMATTR Value 19.3m
SYMBOL res -3792 -848 R0
SYMATTR InstName Rn1
SYMATTR Value 87.4k
SYMBOL cap -3648 -832 R0
SYMATTR InstName Cn1
SYMATTR Value 1.2n
SYMBOL e -3408 -864 R0
SYMATTR InstName Av
SYMATTR Value 1
SYMBOL res -3200 -896 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName ro
SYMATTR Value 1.3
SYMBOL res -3120 -784 R0
SYMATTR InstName R24
SYMATTR Value 3.16k
SYMBOL res -2912 -864 R0
SYMATTR InstName R25
SYMATTR Value {RL}
SYMBOL cap -2752 -848 R0
SYMATTR InstName C4
SYMATTR Value {CL}
SYMBOL cap -3584 -544 R0
SYMATTR InstName C5
SYMATTR Value 1Meg
SYMBOL ind -3360 -576 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L2
SYMATTR Value 1Meg
SYMBOL res -3120 -528 R0
SYMATTR InstName R26
SYMATTR Value 1k
SYMBOL npn -8848 -1376 R0
SYMATTR InstName Q9
SYMATTR Value BC546B
SYMBOL cap -8368 -1984 R0
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL Opamps\\opamp2 -6272 -1488 M180
SYMATTR InstName U6
SYMATTR Value LM358
SYMBOL Opamps\\opamp2 -6800 -1504 M180
SYMATTR InstName U1
SYMATTR Value LM358
SYMBOL Opamps\\opamp2 -6784 -1120 M180
SYMATTR InstName U2
SYMATTR Value LM358
SYMBOL Opamps\\opamp2 -8016 -1328 R180
SYMATTR InstName U3
SYMATTR Value LM358
SYMBOL Opamps\\opamp2 -7632 -1536 R90
SYMATTR InstName U5
SYMATTR Value LM358
SYMBOL res -6768 -2320 R0
SYMATTR InstName R22
SYMATTR Value 1
SYMBOL res -9024 -1264 R0
SYMATTR InstName R21
SYMATTR Value 470
SYMBOL res -8800 -1264 R0
SYMATTR InstName R23
SYMATTR Value 470
SYMBOL cap -8016 -1168 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 100n
SYMBOL cap -7408 -1552 R0
SYMATTR InstName C8
SYMATTR Value 100n
TEXT -6080 -2376 Left 2 !.param RL 500
TEXT -6088 -1904 Left 2 !;step param RE 1k 1.5k 100
TEXT -6080 -2312 Left 2 !.param RE 470
TEXT -6088 -1856 Left 2 !;step param RL 100 0.1 0.25
TEXT -5616 -2416 Left 2 ;Mido regulacion de linea
TEXT -5616 -2376 Left 2 !.meas DC Vo1rl FIND V(Vo) AT=6.25
TEXT -5616 -2352 Left 2 !.meas DC Vo2rl FIND V(Vo) AT=6.45
TEXT -5616 -2328 Left 2 !.meas DC RegLin PARAM ((Vo2rl-Vo1rl)/0.2)
TEXT -5616 -2272 Left 2 ;Mido regulacion de carga
TEXT -5616 -2232 Left 2 !.meas OP Vo1rc FIND V(Vo) AT 100
TEXT -5616 -2208 Left 2 !.meas OP Vo2rc FIND V(Vo) AT 10
TEXT -5616 -2184 Left 2 !.meas OP Io1rc FIND I(RL) AT 100
TEXT -5616 -2160 Left 2 !.meas OP Io2rc FIND I(RL) AT 10
TEXT -5608 -2096 Left 2 ;Mido eficiencia
TEXT -5608 -2056 Left 2 ;-100*((V(vo)*I(RL))/(V(VIN)*I(VIN)))
TEXT -5608 -2136 Left 2 !.meas OP RegCar PARAM (-(Vo2rc-Vo1rc)/(Io2rc-Io1rc))
TEXT -8400 -1616 Left 2 ;Lazo de Corriente
TEXT -5608 -1928 Left 2 !;include TL081.txt
TEXT -7192 -1672 Left 2 ;Referencia Lazo de Corriente
TEXT -6088 -1776 Left 2 !;step param VINDC 4 12 0.1
TEXT -6312 -1664 Left 2 ;Sumador
TEXT -9352 -1632 Left 2 ;Selector
TEXT -5608 -1896 Left 2 !.lib opamp.sub
TEXT -9088 -1632 Left 2 ;Fuente de corriente de polarizacion\nEspejo Simple
TEXT -6080 -2344 Left 2 !.param CL 15u
TEXT -6072 -2416 Left 2 ;Parametros de carga
TEXT -6072 -2192 Left 2 ;Parametros de fuentes
TEXT -6072 -1952 Left 2 ;Parametros de simulacion
TEXT -4128 -952 Left 2 ;Modelo Pequeña Señal
TEXT -5608 -2000 Left 2 ;Modelos de simulacion
TEXT -6088 -1816 Left 2 !;step param CL list 1u 15u
TEXT -5608 -1824 Left 2 !.MODEL TIP42C PNP(Is=66.19f Xti=3 Eg=1.11 Vaf=100 Bf=137.6 Ise=862.2f Ne=1.481 Ikf=1.642 Nk=.5695 Xtb=2 Br=5.88 Isc=273.5f Nc=1.24 Ikr=3.555 Rc=79.39m Cjc=870.4p Mjc=.6481 Vjc=.75 Fc=.5 Cje=390.1p Mje=.4343 Vje=.75 Tr=235.4n Tf=23.21n Itf=71.33 Xtf=5.982 Vtf=10 Rb=.1 Vceo=100 Icrating=6 mfg=Texas)
TEXT -5608 -1864 Left 2 !.include 2N6487.lib
TEXT -5608 -1960 Left 2 !.include LM358.txt
TEXT -5608 -1792 Left 2 !.model SW SW (Ron = 0.1 Roff = 100Meg Vt=0.5 Vh=0.25 )
