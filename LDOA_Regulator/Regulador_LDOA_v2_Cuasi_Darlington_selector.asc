Version 4
SHEET 1 2316 856
WIRE -8688 -2384 -9024 -2384
WIRE -8464 -2384 -8688 -2384
WIRE -8144 -2384 -8464 -2384
WIRE -8000 -2384 -8048 -2384
WIRE -7840 -2384 -8000 -2384
WIRE -7664 -2384 -7840 -2384
WIRE -7424 -2384 -7584 -2384
WIRE -7264 -2384 -7424 -2384
WIRE -8576 -2256 -8624 -2256
WIRE -8528 -2256 -8576 -2256
WIRE -7840 -2240 -7840 -2384
WIRE -8096 -2224 -8096 -2320
WIRE -8000 -2224 -8000 -2384
WIRE -9024 -2176 -9024 -2384
WIRE -8688 -2176 -8688 -2208
WIRE -8576 -2176 -8576 -2256
WIRE -8576 -2176 -8688 -2176
WIRE -8464 -2144 -8464 -2208
WIRE -8272 -2144 -8464 -2144
WIRE -8048 -2144 -8048 -2160
WIRE -8048 -2144 -8272 -2144
WIRE -8688 -2096 -8688 -2176
WIRE -8464 -2096 -8464 -2144
WIRE -7424 -2096 -7424 -2384
WIRE -7264 -2096 -7264 -2384
WIRE -8752 -2048 -8816 -2048
WIRE -7840 -2048 -7840 -2160
WIRE -7840 -2048 -8400 -2048
WIRE -7840 -2032 -7840 -2048
WIRE -8816 -2000 -8816 -2048
WIRE -8688 -1968 -8688 -2000
WIRE -8576 -1968 -8688 -1968
WIRE -8464 -1968 -8464 -2000
WIRE -8464 -1968 -8576 -1968
WIRE -8576 -1936 -8576 -1968
WIRE -7840 -1936 -7840 -1952
WIRE -7632 -1936 -7840 -1936
WIRE -7840 -1920 -7840 -1936
WIRE -7536 -1856 -7584 -1856
WIRE -9024 -1824 -9024 -2096
WIRE -8816 -1824 -8816 -1920
WIRE -8816 -1824 -9024 -1824
WIRE -8576 -1824 -8576 -1856
WIRE -8576 -1824 -8816 -1824
WIRE -7840 -1824 -7840 -1840
WIRE -7840 -1824 -8576 -1824
WIRE -7632 -1824 -7632 -1840
WIRE -7632 -1824 -7840 -1824
WIRE -7424 -1824 -7424 -2016
WIRE -7424 -1824 -7632 -1824
WIRE -7264 -1824 -7264 -2032
WIRE -7264 -1824 -7424 -1824
WIRE -7888 -1696 -7888 -1712
WIRE -8128 -1600 -8160 -1600
WIRE -7984 -1600 -8048 -1600
WIRE -7952 -1600 -7984 -1600
WIRE -7888 -1600 -7888 -1616
WIRE -7888 -1600 -7920 -1600
WIRE -7760 -1600 -7888 -1600
WIRE -7136 -1584 -7152 -1584
WIRE -6944 -1584 -7056 -1584
WIRE -6832 -1584 -6944 -1584
WIRE -8160 -1568 -8160 -1600
WIRE -7952 -1568 -7952 -1600
WIRE -7920 -1568 -7920 -1600
WIRE -7760 -1568 -7760 -1600
WIRE -6720 -1568 -6768 -1568
WIRE -6656 -1568 -6720 -1568
WIRE -6448 -1568 -6576 -1568
WIRE -6304 -1568 -6448 -1568
WIRE -6832 -1552 -6880 -1552
WIRE -6208 -1552 -6240 -1552
WIRE -6160 -1552 -6208 -1552
WIRE -6944 -1536 -6944 -1584
WIRE -6304 -1536 -6352 -1536
WIRE -6880 -1488 -6880 -1552
WIRE -6720 -1488 -6720 -1568
WIRE -6720 -1488 -6880 -1488
WIRE -9232 -1456 -9232 -1552
WIRE -7936 -1456 -7936 -1504
WIRE -7760 -1456 -7760 -1488
WIRE -7760 -1456 -7936 -1456
WIRE -9456 -1440 -9456 -1472
WIRE -9344 -1440 -9456 -1440
WIRE -8576 -1440 -8576 -1472
WIRE -6944 -1424 -6944 -1456
WIRE -8176 -1408 -8224 -1408
WIRE -8144 -1408 -8176 -1408
WIRE -7936 -1408 -7936 -1456
WIRE -7936 -1408 -8064 -1408
WIRE -6352 -1408 -6352 -1536
WIRE -6304 -1408 -6352 -1408
WIRE -6208 -1408 -6208 -1552
WIRE -6208 -1408 -6224 -1408
WIRE -9456 -1392 -9456 -1440
WIRE -9344 -1392 -9344 -1440
WIRE -8480 -1392 -8512 -1392
WIRE -8368 -1392 -8400 -1392
WIRE -8288 -1392 -8368 -1392
WIRE -8208 -1376 -8224 -1376
WIRE -6352 -1360 -6352 -1408
WIRE -8208 -1312 -8208 -1376
WIRE -8144 -1312 -8208 -1312
WIRE -8576 -1296 -8576 -1344
WIRE -9232 -1280 -9232 -1376
WIRE -8368 -1264 -8368 -1392
WIRE -8320 -1264 -8368 -1264
WIRE -8208 -1264 -8208 -1312
WIRE -8208 -1264 -8240 -1264
WIRE -6352 -1248 -6352 -1280
WIRE -8176 -1232 -8176 -1408
WIRE -7152 -1200 -7168 -1200
WIRE -6944 -1200 -7072 -1200
WIRE -6816 -1200 -6944 -1200
WIRE -6704 -1184 -6752 -1184
WIRE -6656 -1184 -6704 -1184
WIRE -6448 -1184 -6448 -1568
WIRE -6448 -1184 -6576 -1184
WIRE -8576 -1168 -8576 -1216
WIRE -6944 -1168 -6944 -1200
WIRE -6816 -1168 -6848 -1168
WIRE -8176 -1120 -8176 -1152
WIRE -6848 -1120 -6848 -1168
WIRE -6704 -1120 -6704 -1184
WIRE -6704 -1120 -6848 -1120
WIRE -6944 -1056 -6944 -1088
FLAG -8576 -1824 0
FLAG -7424 -2384 Vo
FLAG -8816 -2048 Vref
FLAG -9024 -2384 VIN
FLAG -7840 -2048 Vf
FLAG -7840 -2384 Vs1
FLAG -8176 -1120 0
FLAG -8272 -2144 Vod
FLAG -8576 -1168 0
FLAG -8576 -1472 Vod
FLAG -8064 -1312 Vrefc
FLAG -7984 -1680 Vs1
FLAG -7888 -1712 Vo
FLAG -7968 -1536 -15V
FLAG -8256 -1424 -15V
FLAG -7904 -1536 +15V
FLAG -8256 -1360 +15V
FLAG -9344 -1392 0
FLAG -9456 -1552 +15V
FLAG -9456 -1312 -15V
FLAG -8160 -1568 0
FLAG -6352 -1248 0
FLAG -6944 -1056 0
FLAG -6944 -1424 0
FLAG -6160 -1552 Vrefc
FLAG -7168 -1200 Vf
FLAG -7152 -1584 Vref
FLAG -6800 -1536 +15V
FLAG -6272 -1520 +15V
FLAG -6784 -1152 +15V
FLAG -6800 -1600 -15V
FLAG -6784 -1216 -15V
FLAG -6272 -1584 -15V
FLAG -7536 -1856 SELA
FLAG -9232 -1552 SELA
FLAG -9232 -1280 0
DATAFLAG -7584 -2384 ""
DATAFLAG -8160 -2048 ""
SYMBOL pnp -8624 -2208 R180
WINDOW 3 84 4 Left 2
SYMATTR Value 2N2907
SYMATTR InstName Q3
SYMBOL pnp -8528 -2208 M180
WINDOW 3 84 4 Left 2
SYMATTR Value 2N2907
SYMATTR InstName Q4
SYMBOL npn -8752 -2096 R0
WINDOW 3 56 60 Left 2
SYMATTR Value 2N2222
SYMATTR InstName Q1
SYMBOL npn -8400 -2096 M0
WINDOW 3 56 60 Left 2
SYMATTR Value 2N2222
SYMATTR InstName Q2
SYMBOL res -8592 -1952 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 500
SYMATTR InstName Rp
SYMBOL pnp -8048 -2320 M270
WINDOW 3 84 4 Left 2
SYMATTR Value 2N2907
SYMATTR InstName Q5
SYMBOL npn -8096 -2160 R270
WINDOW 3 56 4 Left 2
SYMATTR Value 2N2222
SYMATTR InstName Q6
SYMBOL res -7856 -2256 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 3.16k
SYMATTR InstName Rf1
SYMBOL res -7856 -1936 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 900
SYMATTR InstName Rf2
SYMBOL res -7440 -2112 R0
SYMATTR InstName RL
SYMATTR Value {RL}
SYMBOL voltage -8816 -2016 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC {VREFAC}
SYMATTR InstName V1
SYMATTR Value {VREFDC}
SYMBOL voltage -9024 -2192 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC {VINAC}
SYMATTR InstName VIN
SYMATTR Value {VINDC}
SYMBOL res -8704 -2400 R0
WINDOW 3 36 68 Left 2
SYMATTR Value {RE}
SYMATTR InstName R3
SYMBOL res -8480 -2400 R0
WINDOW 3 36 68 Left 2
SYMATTR Value {RE}
SYMATTR InstName R2
SYMBOL cap -7280 -2096 R0
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL res -7568 -2400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rs
SYMATTR Value 0.7
SYMBOL OpAmps\\opamp2 -7872 -1536 R90
SYMATTR InstName U1
SYMATTR Value TL081
SYMBOL OpAmps\\opamp2 -8256 -1328 R180
SYMATTR InstName U2
SYMATTR Value TL081
SYMBOL res -8048 -1424 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL res -8048 -1328 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL res -8224 -1280 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res -8192 -1248 R0
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL npn -8512 -1440 M0
SYMATTR InstName Q7
SYMATTR Value 2N2222
SYMBOL res -8592 -1312 R0
SYMATTR InstName R8
SYMATTR Value 1K
SYMBOL voltage -9456 -1568 R0
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL voltage -9456 -1408 R0
SYMATTR InstName V3
SYMATTR Value 15
SYMBOL res -7776 -1584 R0
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res -7904 -1712 R0
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res -7968 -1696 M0
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res -8032 -1616 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL res -8384 -1408 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res -7040 -1600 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 75k
SYMBOL res -6928 -1440 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL res -7168 -1184 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R15
SYMATTR Value 13k
SYMBOL res -6960 -1184 R0
SYMATTR InstName R16
SYMATTR Value 10k
SYMBOL res -6560 -1584 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL res -6560 -1200 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL res -6208 -1424 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 10k
SYMBOL res -6336 -1264 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL OpAmps\\opamp2 -6800 -1504 M180
SYMATTR InstName U3
SYMATTR Value TL081
SYMBOL OpAmps\\opamp2 -6784 -1120 M180
SYMATTR InstName U4
SYMATTR Value TL081
SYMBOL OpAmps\\opamp2 -6272 -1488 M180
SYMATTR InstName U5
SYMATTR Value TL081
SYMBOL res -7856 -2048 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 1k
SYMATTR InstName Rf3
SYMBOL nmos -7584 -1936 M0
SYMATTR InstName M1
SYMATTR Value AO6408
SYMBOL voltage -9232 -1472 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VSELA
SYMATTR Value 5V
TEXT -9056 -1800 Left 2 !.op
TEXT -9056 -1752 Left 2 !;ac dec 20 0.1 10Meg
TEXT -9592 -2376 Left 2 !.param VINDC 6.35
TEXT -9584 -2336 Left 2 !.param VINAC 1
TEXT -9584 -2288 Left 2 !.param VREFDC 1.2
TEXT -9592 -2232 Left 2 !.param VREFAC 0
TEXT -9584 -2192 Left 2 !;param RL 5
TEXT -9056 -1720 Left 2 !;dc VIN 1 12
TEXT -9584 -2144 Left 2 !;step param RE 1k 1.5k 100
TEXT -9584 -2416 Left 2 !.param RE 470
TEXT -9584 -2096 Left 2 !.step param RL 1k 1 10
TEXT -7136 -2376 Left 2 ;Mido regulacion de linea
TEXT -7136 -2336 Left 2 !.meas DC Vo1rl FIND V(Vo) AT=6.25
TEXT -7136 -2312 Left 2 !.meas DC Vo2rl FIND V(Vo) AT=6.45
TEXT -7136 -2288 Left 2 !.meas DC RegLin PARAM ((Vo2rl-Vo1rl)/0.2)
TEXT -7136 -2232 Left 2 ;Mido regulacion de carga
TEXT -7136 -2192 Left 2 !.meas OP Vo1rc FIND V(Vo) AT 100
TEXT -7136 -2168 Left 2 !.meas OP Vo2rc FIND V(Vo) AT 10
TEXT -7136 -2144 Left 2 !.meas OP Io1rc FIND I(RL) AT 100
TEXT -7136 -2120 Left 2 !.meas OP Io2rc FIND I(RL) AT 10
TEXT -7128 -2056 Left 2 ;Mido eficiencia
TEXT -7128 -2016 Left 2 ;-100*((V(vo)*I(RL))/(V(VIN)*I(VIN)))
TEXT -7128 -2096 Left 2 !.meas OP RegCar PARAM (-(Vo2rc-Vo1rc)/(Io2rc-Io1rc))
TEXT -8760 -1752 Left 2 !;tran 0 1m 0 1u
TEXT -8528 -1616 Left 2 ;Lazo de Corriente
TEXT -7488 -1752 Left 2 !.include TL081.txt
TEXT -7192 -1672 Left 2 ;Referencia Lazo de Corriente
TEXT -9584 -2040 Left 2 !;step param VINDC 6.25 6.35 0.01
TEXT -6312 -1664 Left 2 ;Sumador
TEXT -9256 -1632 Left 2 ;Selector
