Version 4
SHEET 1 2316 856
WIRE -8688 -2384 -9024 -2384
WIRE -8464 -2384 -8688 -2384
WIRE -8144 -2384 -8464 -2384
WIRE -8000 -2384 -8048 -2384
WIRE -7936 -2384 -8000 -2384
WIRE -7792 -2384 -7856 -2384
WIRE -7424 -2384 -7792 -2384
WIRE -7264 -2384 -7424 -2384
WIRE -8576 -2256 -8624 -2256
WIRE -8528 -2256 -8576 -2256
WIRE -7792 -2256 -7792 -2384
WIRE -8096 -2224 -8096 -2320
WIRE -8000 -2224 -8000 -2384
WIRE -9024 -2176 -9024 -2384
WIRE -8688 -2176 -8688 -2208
WIRE -8576 -2176 -8576 -2256
WIRE -8576 -2176 -8688 -2176
WIRE -8464 -2144 -8464 -2208
WIRE -8272 -2144 -8464 -2144
WIRE -8048 -2144 -8048 -2160
WIRE -8048 -2144 -8272 -2144
WIRE -8688 -2096 -8688 -2176
WIRE -8464 -2096 -8464 -2144
WIRE -7424 -2096 -7424 -2384
WIRE -7264 -2096 -7264 -2384
WIRE -8752 -2048 -8816 -2048
WIRE -7792 -2048 -7792 -2176
WIRE -7792 -2048 -8400 -2048
WIRE -7792 -2032 -7792 -2048
WIRE -8816 -2000 -8816 -2048
WIRE -8688 -1968 -8688 -2000
WIRE -8576 -1968 -8688 -1968
WIRE -8464 -1968 -8464 -2000
WIRE -8464 -1968 -8576 -1968
WIRE -7792 -1936 -7792 -1952
WIRE -7584 -1936 -7792 -1936
WIRE -7792 -1920 -7792 -1936
WIRE -7488 -1856 -7536 -1856
WIRE -9024 -1824 -9024 -2096
WIRE -8816 -1824 -8816 -1920
WIRE -8816 -1824 -9024 -1824
WIRE -8320 -1824 -8816 -1824
WIRE -7792 -1824 -7792 -1840
WIRE -7792 -1824 -8320 -1824
WIRE -7584 -1824 -7584 -1840
WIRE -7584 -1824 -7792 -1824
WIRE -7424 -1824 -7424 -2016
WIRE -7424 -1824 -7584 -1824
WIRE -7264 -1824 -7264 -2032
WIRE -7264 -1824 -7424 -1824
WIRE -8320 -1792 -8320 -1824
WIRE -8176 -1584 -8176 -1600
WIRE -7760 -1504 -7776 -1504
WIRE -7568 -1504 -7680 -1504
WIRE -7456 -1504 -7568 -1504
WIRE -9280 -1488 -9280 -1520
WIRE -8416 -1488 -8448 -1488
WIRE -8272 -1488 -8336 -1488
WIRE -8240 -1488 -8272 -1488
WIRE -8176 -1488 -8176 -1504
WIRE -8176 -1488 -8208 -1488
WIRE -8048 -1488 -8176 -1488
WIRE -7344 -1488 -7392 -1488
WIRE -7280 -1488 -7344 -1488
WIRE -7072 -1488 -7200 -1488
WIRE -6928 -1488 -7072 -1488
WIRE -7456 -1472 -7504 -1472
WIRE -6832 -1472 -6864 -1472
WIRE -6784 -1472 -6832 -1472
WIRE -8448 -1456 -8448 -1488
WIRE -8240 -1456 -8240 -1488
WIRE -8208 -1456 -8208 -1488
WIRE -8048 -1456 -8048 -1488
WIRE -7568 -1456 -7568 -1504
WIRE -6928 -1456 -6976 -1456
WIRE -9536 -1440 -9536 -1536
WIRE -9168 -1424 -9168 -1472
WIRE -7504 -1408 -7504 -1472
WIRE -7344 -1408 -7344 -1488
WIRE -7344 -1408 -7504 -1408
WIRE -9280 -1376 -9280 -1408
WIRE -9232 -1376 -9280 -1376
WIRE -8224 -1344 -8224 -1392
WIRE -8048 -1344 -8048 -1376
WIRE -8048 -1344 -8224 -1344
WIRE -7568 -1344 -7568 -1376
WIRE -8864 -1328 -8864 -1360
WIRE -6976 -1328 -6976 -1456
WIRE -6928 -1328 -6976 -1328
WIRE -6832 -1328 -6832 -1472
WIRE -6832 -1328 -6848 -1328
WIRE -8464 -1296 -8512 -1296
WIRE -8432 -1296 -8464 -1296
WIRE -8224 -1296 -8224 -1344
WIRE -8224 -1296 -8352 -1296
WIRE -9168 -1280 -9168 -1328
WIRE -8656 -1280 -8720 -1280
WIRE -8576 -1280 -8656 -1280
WIRE -6976 -1280 -6976 -1328
WIRE -9536 -1264 -9536 -1360
WIRE -8496 -1264 -8512 -1264
WIRE -8496 -1200 -8496 -1264
WIRE -8432 -1200 -8496 -1200
WIRE -8864 -1184 -8864 -1232
WIRE -6976 -1168 -6976 -1200
WIRE -9168 -1152 -9168 -1200
WIRE -8656 -1152 -8656 -1280
WIRE -8608 -1152 -8656 -1152
WIRE -8496 -1152 -8496 -1200
WIRE -8496 -1152 -8528 -1152
WIRE -8464 -1120 -8464 -1296
WIRE -7776 -1120 -7792 -1120
WIRE -7568 -1120 -7696 -1120
WIRE -7440 -1120 -7568 -1120
WIRE -7328 -1104 -7376 -1104
WIRE -7280 -1104 -7328 -1104
WIRE -7072 -1104 -7072 -1488
WIRE -7072 -1104 -7200 -1104
WIRE -7568 -1088 -7568 -1120
WIRE -7440 -1088 -7472 -1088
WIRE -7472 -1040 -7472 -1088
WIRE -7328 -1040 -7328 -1104
WIRE -7328 -1040 -7472 -1040
WIRE -8464 -1008 -8464 -1040
WIRE -7568 -976 -7568 -1008
FLAG -8320 -1792 0
FLAG -7424 -2384 Vo
FLAG -8816 -2048 Vref
FLAG -9024 -2384 VIN
FLAG -7792 -2048 Vf
FLAG -8000 -2384 Vs1
FLAG -8464 -1008 0
FLAG -8272 -2144 Vod
FLAG -8864 -1360 Vod
FLAG -8352 -1200 Vrefc
FLAG -8272 -1568 Vs1
FLAG -8176 -1600 Vo
FLAG -8448 -1456 0
FLAG -6976 -1168 0
FLAG -7568 -976 0
FLAG -7568 -1344 0
FLAG -7792 -1120 Vf
FLAG -7776 -1504 Vref
FLAG -7488 -1856 SELA
FLAG -9536 -1536 SELA
FLAG -9536 -1264 0
FLAG -6784 -1472 Vrefc
FLAG -8224 -1296 Vs
FLAG -8864 -1184 0
FLAG -8576 -1968 Pol
FLAG -9168 -1472 Pol
FLAG -9168 -1152 0
FLAG -9280 -1520 Vref
DATAFLAG -7552 -2384 ""
DATAFLAG -8160 -2048 ""
SYMBOL pnp -8624 -2208 R180
WINDOW 3 84 4 Left 2
SYMATTR Value BC327-25
SYMATTR InstName Q3
SYMBOL pnp -8528 -2208 M180
WINDOW 3 84 4 Left 2
SYMATTR Value BC327-25
SYMATTR InstName Q4
SYMBOL npn -8752 -2096 R0
WINDOW 3 56 60 Left 2
SYMATTR Value BC546B
SYMATTR InstName Q1
SYMBOL npn -8400 -2096 M0
WINDOW 3 56 60 Left 2
SYMATTR Value BC546B
SYMATTR InstName Q2
SYMBOL pnp -8048 -2320 M270
WINDOW 3 84 4 Left 2
SYMATTR Value 2SAR554P
SYMATTR InstName Q5
SYMBOL npn -8096 -2160 R270
WINDOW 3 56 4 Left 2
SYMATTR Value BC546B
SYMATTR InstName Q6
SYMBOL res -7808 -2272 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 3.16k
SYMATTR InstName Rf1
SYMBOL res -7808 -1936 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 840
SYMATTR InstName Rf2
SYMBOL res -7440 -2112 R0
SYMATTR InstName RL
SYMATTR Value {RL}
SYMBOL voltage -8816 -2016 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC {VREFAC}
SYMATTR InstName V1
SYMATTR Value {VREFDC}
SYMBOL voltage -9024 -2192 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC {VINAC}
SYMATTR InstName VIN
SYMATTR Value {VINDC}
SYMBOL res -8704 -2400 R0
WINDOW 3 36 68 Left 2
SYMATTR Value {RE}
SYMATTR InstName R3
SYMBOL res -8480 -2400 R0
WINDOW 3 36 68 Left 2
SYMATTR Value {RE}
SYMATTR InstName R2
SYMBOL cap -7280 -2096 R0
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL res -7840 -2400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rs
SYMATTR Value 0.1
SYMBOL res -8336 -1312 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL res -8336 -1216 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL res -8512 -1168 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res -8480 -1136 R0
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL npn -8800 -1328 M0
SYMATTR InstName Q7
SYMATTR Value 2N2222
SYMBOL res -8064 -1472 R0
SYMATTR InstName R9
SYMATTR Value 100k
SYMBOL res -8192 -1600 R0
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res -8256 -1584 M0
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res -8320 -1504 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 100k
SYMBOL res -7664 -1520 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 50k
SYMBOL res -7552 -1360 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL res -7792 -1104 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R15
SYMATTR Value 54.4k
SYMBOL res -7584 -1104 R0
SYMATTR InstName R16
SYMATTR Value 46k
SYMBOL res -7184 -1504 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL res -7184 -1120 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL res -6832 -1344 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 10k
SYMBOL res -6960 -1184 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL res -7808 -2048 R0
WINDOW 3 36 68 Left 2
SYMATTR Value 1k
SYMATTR InstName Rf3
SYMBOL nmos -7536 -1936 M0
SYMATTR InstName M1
SYMATTR Value AO6408
SYMBOL voltage -9536 -1456 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName VSELA
SYMATTR Value 5
SYMBOL res -8704 -1296 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 100
SYMBOL OpAmps\\opamp -7424 -1424 M180
SYMATTR InstName U2
SYMBOL OpAmps\\opamp -7408 -1040 M180
SYMATTR InstName U3
SYMBOL OpAmps\\opamp -8160 -1424 R90
SYMATTR InstName U4
SYMBOL OpAmps\\opamp -8544 -1216 R180
SYMATTR InstName U5
SYMBOL OpAmps\\opamp -6896 -1408 M180
SYMATTR InstName U1
SYMBOL npn -9232 -1424 R0
SYMATTR InstName Q8
SYMATTR Value BC546B
SYMBOL res -9296 -1504 R0
SYMATTR InstName R8
SYMATTR Value 100
SYMBOL res -9184 -1296 R0
SYMATTR InstName R21
SYMATTR Value 500
TEXT -9560 -1976 Left 2 !.op
TEXT -9560 -1944 Left 2 !;ac dec 20 0.1 10Meg
TEXT -9560 -2312 Left 2 !.param VINDC 6.35
TEXT -9560 -2272 Left 2 !.param VINAC 1
TEXT -9560 -2224 Left 2 !.param VREFDC 1.2
TEXT -9560 -2184 Left 2 !.param VREFAC 0
TEXT -9560 -2144 Left 2 !;param RL 10
TEXT -9560 -1904 Left 2 !;dc VIN 1 12
TEXT -9560 -2096 Left 2 !;step param RE 1k 1.5k 100
TEXT -9560 -2352 Left 2 !.param RE 470
TEXT -9560 -2056 Left 2 !.step param RL 100 0.1 0.25
TEXT -7144 -2336 Left 2 ;Mido regulacion de linea
TEXT -7144 -2296 Left 2 !.meas DC Vo1rl FIND V(Vo) AT=6.25
TEXT -7144 -2272 Left 2 !.meas DC Vo2rl FIND V(Vo) AT=6.45
TEXT -7144 -2248 Left 2 !.meas DC RegLin PARAM ((Vo2rl-Vo1rl)/0.2)
TEXT -7144 -2192 Left 2 ;Mido regulacion de carga
TEXT -7144 -2152 Left 2 !.meas OP Vo1rc FIND V(Vo) AT 100
TEXT -7144 -2128 Left 2 !.meas OP Vo2rc FIND V(Vo) AT 10
TEXT -7144 -2104 Left 2 !.meas OP Io1rc FIND I(RL) AT 100
TEXT -7144 -2080 Left 2 !.meas OP Io2rc FIND I(RL) AT 10
TEXT -7136 -2016 Left 2 ;Mido eficiencia
TEXT -7136 -1976 Left 2 ;-100*((V(vo)*I(RL))/(V(VIN)*I(VIN)))
TEXT -7136 -2056 Left 2 !.meas OP RegCar PARAM (-(Vo2rc-Vo1rc)/(Io2rc-Io1rc))
TEXT -9560 -1864 Left 2 !;tran 0 1m 0 1u
TEXT -8816 -1616 Left 2 ;Lazo de Corriente
TEXT -7136 -1864 Left 2 !.include TL081.txt
TEXT -7824 -1616 Left 2 ;Referencia Lazo de Corriente
TEXT -9560 -2016 Left 2 !;step param VINDC 4 32 0.5
TEXT -6968 -1608 Left 2 ;Sumador
TEXT -9560 -1616 Left 2 ;Selector
TEXT -7136 -1832 Left 2 !.lib opamp.sub
TEXT -9368 -1616 Left 2 ;Fuente de corriente de polarizacion
