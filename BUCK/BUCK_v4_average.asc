Version 4
SHEET 1 1932 1700
WIRE -400 -784 -640 -784
WIRE -640 -752 -640 -784
WIRE -400 -736 -400 -784
WIRE -192 -736 -400 -736
WIRE -928 -704 -1200 -704
WIRE -400 -704 -400 -736
WIRE -688 -688 -864 -688
WIRE -1200 -672 -1200 -704
WIRE -1200 -672 -1248 -672
WIRE -1200 -656 -1200 -672
WIRE -1152 -656 -1200 -656
WIRE -1024 -656 -1072 -656
WIRE -928 -656 -1024 -656
WIRE -848 -656 -864 -656
WIRE -640 -656 -640 -672
WIRE -640 -656 -752 -656
WIRE -640 -640 -640 -656
WIRE -848 -576 -848 -656
WIRE -688 -576 -848 -576
WIRE -640 -544 -640 -560
WIRE -400 -544 -400 -624
WIRE -400 -544 -640 -544
WIRE -1856 -528 -1856 -624
WIRE -1440 -528 -1440 -624
WIRE -640 -496 -640 -544
WIRE -400 -416 -640 -416
WIRE -640 -384 -640 -416
WIRE -400 -368 -400 -416
WIRE -320 -368 -400 -368
WIRE -192 -368 -192 -736
WIRE -192 -368 -256 -368
WIRE -960 -352 -1200 -352
WIRE -1856 -336 -1856 -448
WIRE -1440 -336 -1440 -448
WIRE -1200 -336 -1200 -352
WIRE -1200 -336 -1248 -336
WIRE -736 -336 -896 -336
WIRE -400 -336 -400 -368
WIRE -736 -320 -736 -336
WIRE -688 -320 -736 -320
WIRE -1200 -304 -1200 -336
WIRE -1168 -304 -1200 -304
WIRE -1040 -304 -1088 -304
WIRE -960 -304 -1040 -304
WIRE -864 -304 -896 -304
WIRE -640 -288 -640 -304
WIRE -640 -288 -768 -288
WIRE -640 -272 -640 -288
WIRE -864 -208 -864 -304
WIRE -688 -208 -864 -208
WIRE -640 -176 -640 -192
WIRE -400 -176 -400 -272
WIRE -400 -176 -640 -176
WIRE -640 -128 -640 -176
WIRE -1200 -32 -1312 -32
WIRE -1040 -32 -1136 -32
WIRE -1584 96 -1840 96
WIRE -1312 96 -1312 -32
WIRE -1312 96 -1584 96
WIRE -1232 96 -1312 96
WIRE -1040 96 -1040 -32
WIRE -1040 96 -1136 96
WIRE -672 96 -1040 96
WIRE -384 96 -672 96
WIRE -336 96 -384 96
WIRE -80 96 -256 96
WIRE 64 96 -80 96
WIRE 288 96 64 96
WIRE -80 128 -80 96
WIRE 64 128 64 96
WIRE -1040 144 -1040 96
WIRE -1152 160 -1152 144
WIRE -1840 176 -1840 96
WIRE 288 176 288 96
WIRE -1584 192 -1584 96
WIRE -672 192 -672 96
WIRE -384 208 -384 96
WIRE -80 240 -80 208
WIRE 64 240 64 208
WIRE -1152 272 -1152 240
WIRE -848 272 -896 272
WIRE -720 272 -768 272
WIRE -672 288 -672 272
WIRE -1840 352 -1840 256
WIRE -1584 352 -1584 256
WIRE -1584 352 -1840 352
WIRE -672 352 -672 288
WIRE -672 352 -1584 352
WIRE -384 352 -384 272
WIRE -384 352 -672 352
WIRE -80 352 -80 304
WIRE -80 352 -384 352
WIRE 64 352 64 304
WIRE 64 352 -80 352
WIRE 288 352 288 256
WIRE 288 352 64 352
WIRE -1840 384 -1840 352
WIRE -688 576 -1056 576
WIRE -528 576 -688 576
WIRE -272 576 -448 576
WIRE -128 576 -272 576
WIRE 48 576 -128 576
WIRE 96 576 48 576
WIRE -272 608 -272 576
WIRE -128 608 -128 576
WIRE -960 656 -1424 656
WIRE 96 656 96 576
WIRE -272 720 -272 688
WIRE -128 720 -128 688
WIRE -1424 736 -1424 656
WIRE -960 736 -960 656
WIRE -896 736 -960 736
WIRE -688 736 -688 576
WIRE -688 736 -768 736
WIRE -1056 784 -1056 576
WIRE -896 784 -1056 784
WIRE -512 784 -768 784
WIRE -272 832 -272 784
WIRE -128 832 -128 784
WIRE -128 832 -272 832
WIRE 96 832 96 736
WIRE 96 832 -128 832
WIRE -832 880 -832 800
WIRE -928 928 -1024 928
WIRE -832 1024 -832 960
WIRE -512 1024 -512 784
WIRE -1424 1040 -1424 816
WIRE -128 1040 -128 832
WIRE -1024 1104 -1024 928
WIRE -1024 1120 -1024 1104
WIRE 48 1168 48 576
WIRE -1024 1216 -1024 1200
WIRE 48 1280 48 1248
WIRE 48 1280 -688 1280
WIRE -1408 1296 -1408 1280
WIRE -1024 1296 -1024 1216
WIRE -752 1296 -1024 1296
WIRE -2224 1312 -2224 1296
WIRE -1984 1312 -1984 1296
WIRE -624 1312 -688 1312
WIRE -1984 1328 -1984 1312
WIRE 48 1328 48 1280
WIRE -2224 1344 -2224 1312
WIRE -624 1360 -624 1312
WIRE -720 1408 -720 1328
WIRE -1408 1424 -1408 1376
WIRE 48 1424 48 1408
WIRE -1984 1440 -1984 1408
WIRE -624 1472 -624 1440
FLAG -1856 -336 0
FLAG -1840 384 0
FLAG -1856 -624 VG1
FLAG -1152 272 VG_1
FLAG 288 96 VREG
FLAG -1440 -624 VG2
FLAG -1440 -336 0
FLAG -896 272 VG_2
FLAG -1040 -240 0
FLAG -1024 -592 0
FLAG -1248 -336 VG1
FLAG -1248 -672 VG2
FLAG -688 -624 0
FLAG -688 -736 0
FLAG -688 -256 0
FLAG -688 -368 0
FLAG -768 -288 VG_1
FLAG -752 -656 VG_2
FLAG -640 -496 0
FLAG -1040 144 VS1
FLAG -640 -128 VS1
FLAG -1408 1424 0
FLAG -1408 1280 d
FLAG -1424 1040 0
FLAG 96 576 VREG_2
FLAG -512 1024 0
FLAG -128 1040 0
FLAG -688 576 Vsw
FLAG 48 1424 0
FLAG -720 1408 0
FLAG -624 1472 0
FLAG -2224 1312 VPOS
FLAG -832 1024 0
FLAG -928 928 ctrl
IOPIN -928 928 Out
FLAG -1024 1104 x
FLAG -1024 1216 y
FLAG 48 1280 Vf_buck
FLAG -1984 1440 0
FLAG -1984 1312 VPOS
SYMBOL voltage -1840 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 36
SYMBOL ind -352 112 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 90µ
SYMBOL cap -96 240 R0
SYMATTR InstName C1
SYMATTR Value 10µ
SYMBOL nmos -1232 144 R270
SYMATTR InstName M1
SYMATTR Value IRF530
SYMBOL voltage -1856 -544 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 12 2p 1p 1p 910n 5u)
SYMBOL voltage -1440 -544 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value PULSE(12 0 2p 1p 1p 910n 5u)
SYMBOL nmos -720 192 R0
SYMATTR InstName M2
SYMATTR Value IRF530
SYMBOL cap 48 240 R0
SYMATTR InstName C2
SYMATTR Value 1n
SYMBOL res 272 160 R0
SYMATTR InstName RL
SYMATTR Value 4.3
SYMBOL diode -368 272 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value RF05VAM1S
SYMBOL diode -1136 -48 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMBOL Digital\\and -928 -384 R0
SYMATTR InstName A2
SYMBOL cap -1056 -304 R0
SYMATTR InstName C3
SYMATTR Value 15p
SYMBOL res -1072 -320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL Digital\\and -896 -736 R0
SYMATTR InstName A1
SYMBOL cap -1040 -656 R0
SYMATTR InstName C4
SYMATTR Value 15p
SYMBOL res -1056 -672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL sw -640 -768 R0
SYMATTR InstName S1
SYMATTR Value SW_1
SYMBOL sw -640 -656 R0
SYMATTR InstName S2
SYMATTR Value SW_1
SYMBOL voltage -400 -720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 9
SYMBOL sw -640 -400 R0
SYMATTR InstName S3
SYMATTR Value SW_1
SYMBOL sw -640 -288 R0
SYMATTR InstName S4
SYMATTR Value SW_1
SYMBOL cap -416 -336 R0
SYMATTR InstName C5
SYMATTR Value 150n
SYMBOL diode -256 -384 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL res -96 112 R0
SYMATTR InstName R3
SYMATTR Value 30
SYMBOL res 48 112 R0
SYMATTR InstName R4
SYMATTR Value 0.1
SYMBOL cap -1600 192 R0
SYMATTR InstName C6
SYMATTR Value 0
SYMBOL res -752 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rdrv2
SYMATTR Value 5
SYMBOL res -1168 144 R0
SYMATTR InstName Rdrv1
SYMATTR Value 5
SYMBOL voltage -1408 1280 R0
WINDOW 3 -374 105 Left 2
WINDOW 123 -87 77 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL(0 0.174 5.01m 0.174 5.02m 0.180)
SYMATTR Value2 AC 1
SYMATTR InstName Vduty1
SYMBOL ccm1 -832 768 R0
SYMATTR InstName U1
SYMATTR Value CCM2
SYMATTR SpiceLine Ron=0.16
SYMATTR SpiceLine2 VD=0 RD=0.16
SYMBOL voltage -1424 720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 36
SYMBOL ind -544 592 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 90µ
SYMBOL cap -288 720 R0
SYMATTR InstName C7
SYMATTR Value 10µ
SYMBOL cap -144 720 R0
SYMATTR InstName C8
SYMATTR Value 1n
SYMBOL res 80 640 R0
SYMATTR InstName RL1
SYMATTR Value 4.3
SYMBOL res -288 592 R0
SYMATTR InstName R5
SYMATTR Value 30
SYMBOL res -144 592 R0
SYMATTR InstName R6
SYMATTR Value 0.1
SYMBOL res 32 1152 R0
SYMATTR InstName R7
SYMATTR Value 4.3k
SYMBOL res 32 1312 R0
SYMATTR InstName R8
SYMATTR Value 1k
SYMBOL Opamps\\LT1215 -2224 1312 M0
SYMATTR InstName U2
SYMBOL voltage -624 1344 R0
WINDOW 123 24 116 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value2 AC 0
SYMATTR InstName Vref1
SYMATTR Value 1.2
SYMBOL bv -832 864 R0
SYMATTR InstName B1
SYMATTR Value V=limit(v(ctrl), 0.01, 0.9)
SYMBOL voltage -1024 1104 R0
WINDOW 0 41 45 Left 2
WINDOW 123 37 65 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vz1
SYMATTR Value2 AC 1
SYMATTR Value ""
SYMBOL voltage -1984 1312 R0
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 0
SYMATTR InstName Vg1
SYMATTR Value 12
SYMBOL Opamps\\opamp2 -720 1232 M0
SYMATTR InstName U3
TEXT -2200 -96 Left 2 !;tran 0 500u 0 0.1u
TEXT -2192 -56 Left 2 !;step param C2 list 500n 600n 700n 800n 1u
TEXT -112 -728 Left 2 ;pongo un 1 y me genera un retardo ya que el capacitor se tiene que cargar  a diferencia del 0 que es automatico
TEXT -104 -688 Left 2 ;voy a agregarle la diferencia entre vg1 y vg2
TEXT -96 -640 Left 2 !.Model SW_1 SW(Ron=0.1 Roff=10Meg Vt=0.5V)
TEXT -88 -592 Left 2 !.Model SW_2 SW(Ron=10Meg Roff=1 Vt=0.5V)
TEXT -56 -512 Left 2 ;c5 en una fuente auxiliar para llegar a mis 8 volt para prender el mos
TEXT -48 -456 Left 2 ;diodo para que el capacitor no se descargue
TEXT -32 -408 Left 2 ;yo pongo el capacitor para generar vgs=8v igual que esten flotando los terminales
TEXT -2320 776 Left 2 !.lib switching_average\\switching.lib
TEXT -2320 832 Left 2 !.lib switching_average\\average.lib
TEXT -2312 720 Left 2 ;Librerias de simulacion
TEXT -2320 992 Left 2 !.tran 0 0.5m 0 1u
TEXT -2320 1040 Left 2 !;ac dec 300 10 1Meg
TEXT -2320 944 Left 2 ;Tipos de simulacion
TEXT -2312 880 Left 2 !.inc LM339.txt
